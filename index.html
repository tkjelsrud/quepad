<html>
<head>
  <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="cache-control" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
  <meta http-equiv="pragma" content="no-cache" />
  <title>v 0.0.1</title>
  <script src="js/jquery-3.1.1.min.js"></script>
  <script src="js/jquery-ui.js"></script>
  <script src="js/quepad.js"></script>

  <style>
    :root {
      --colorA: #f0e3c4;
      --colorB: #daa592;
      --colorC: #f1f0d1;
      --colorD: #aeeff0;
      --colorE: #fcf594;
      --colorF: #010059;
    }
    body {
      /*background-image: url('img/sky.png');*/
      background-color: var(--colorE);
      font-family: Verdana;
    }
    .column {
      float: left;
      width: 200px;
      height: 200px;
    }
    .summary {
      float: right;
      background-color: var(--colorC);
      height: 100%;
    }
    .title {
      float: left;
      height: 30px;
      width: 100%;
      margin-bottom: 10px;
      color: var(--colorF);
    }

    .process {
      float: left;
      width: 90%;
      min-height  : 200px;
      border: 1px solid grey;
      margin-bottom: 10px;
      background-color: var(--colorA);
      padding: 4px;
      font-size: 11px;
      box-shadow: 1px 2px 1px #999;
    }

    .alternative {
      background-color: var(--colorB);
    }

    .add {
      text-align:center;
      font-size: 24px;
    }
  </style>

  <script type="text/javascript">
    function updateSummary() {
      //get path
      elList = document.getElementsByClassName('process');
      pList = new Array();

      for(i = 0; i < elList.length; i++ ) {
        pList[i] = (parseText(elList[i], false));
      }

      // Summarize
      sum = summarize(pList);
      document.getElementById('summaryText').innerText = 'Lead time MIN: ' + sum.LD[0] + '\n' +
        'Lead time MAX: ' + sum.LD[1] + '\n' + 'Task count: ' + sum.TASKS;

      // Summarize alternative
      for(i = 0; i < elList.length; i++ ) {
        pList[i] = (parseText(elList[i], true));
      }

      sumA = summarize(pList);

      document.getElementById('summaryText').innerText += '\n\nALTERNATIVE\nLead time MIN: ' + sumA.LD[0] + '\n' +
        'Lead time MAX: ' + sumA.LD[1] + '\n' + 'Task count: ' + sumA.TASKS + ' (' + Math.floor(sumA.TASKS/sum.TASKS * 100)  + '%)';

      //alternative
      //document.getElementsByClassName('process')[1].classList.contains('alternative')
      console.log(pList);
      console.log(sum);
    }
  </script>
</head>

<body>
  <!-- -->
  <div class="column">
    <div class="title" contenteditable="true">Business processing</div>
    <div id="bp1" class="process" contenteditable="true">Upstream process resulting in an epic task<br/>LD 14,30<br/>Split 1:3<br/><br/>ALT<br/>Improved WIP and focus<br/>SPLIT 1:2</div>
  </div>
  <div class="column">
    <div class="title" contenteditable="true">Something else</div>
    <div id="bp2" class="process" contenteditable="true">Analysis<br/>LD 14,30<br/>Split 1:2</br></div>
    <!--div id="bp2b" class="process alternative" contenteditable="true">I'm an alternative process<br/>LD [14,30]<br/>Split 1:2</br>Flow 0.8</div>
    <div class="showalt">Add alternative</div-->
  </div>
  <div class="column">
    <div id="bp3" class="title" contenteditable="true">Selection</div>
    <div class="process" contenteditable="true">Selection<br/>LD 14,30<br/>Split 1:2</br></div>
  </div>
  <div class="column" style="">
    <div class="title" contenteditable="true">Development</div>
    <div class="process" contenteditable="true">Development<br/>LD 20-60<br/>Split 1:2</br></div>
  </div>
  <div class="column" style="">
    <div class="title" contenteditable="true">Testing</div>
    <div class="process" contenteditable="true">Testing<br/>LD 5<br/>Split 1:3</br>Flow 0.8</div>
  </div>
  <div class="column summary">
    <div class="title" contenteditable="true">Summary</div>
    <div id="summaryText" class="text">
      LD 123<br/>
      Something 123
    </div>
  </div>
  <script type="text/javascript">
    $('body').on('blur keyup paste input', '[contenteditable]', function(){
      updateSummary();
    });
  </script>
</body>
</html>
